<script>
async function loadWarns() {
    const container = document.getElementById('warns-container')
    
    try {
        container.innerHTML = '<div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>'
        
        const response = await fetch('/api/warns')
        
        if (!response.ok) {
            const errorData = await response.json().catch(() => ({}))
            throw new Error(`–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ${response.status} - ${errorData.error || 'Unknown error'}`)
        }
        
        const warns = await response.json()

        container.innerHTML = ''

        if (!warns || warns.length === 0) {
            container.innerHTML = '<div class="warn-item">‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –Ω–µ—Ç</div>'
            return
        }

        // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥—ã–π –≤–∞—Ä–Ω
        warns.forEach(warn => {
            const warnElement = document.createElement('div')
            warnElement.className = 'warn-item'
            
            const date = new Date(warn.created_at).toLocaleDateString('ru-RU')
            
            warnElement.innerHTML = `
                <strong>üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> ${warn.user_id}<br>
                <strong>üìù –ü—Ä–∏—á–∏–Ω–∞:</strong> ${warn.reason || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}<br>
                <strong>üìÖ –î–∞—Ç–∞:</strong> ${date}
                <small style="color: #666; display: block; margin-top: 5px;">ID: ${warn.id}</small>
            `
            
            container.appendChild(warnElement)
        })

    } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error)
        container.innerHTML = `
            <div class="error">
                ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}
                <br><br>
                <strong>–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:</strong>
                <ul style="text-align: left; margin: 10px 0;">
                    <li>Environment Variables –≤ Vercel</li>
                    <li>Service Role Key –≤ Supabase</li>
                    <li>–¢–∞–±–ª–∏—Ü–∞ user_warns —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</li>
                </ul>
            </div>
        `
    }
}

document.addEventListener('DOMContentLoaded', loadWarns)
</script>
